import{jsx as o}from"react/jsx-runtime";import{useContext as e,useState as i,useEffect as r,createContext as t}from"react";import{f as n,l as c,u as a,m as l}from"./privy-provider-DkDa6JMm.mjs";import{u as s,P as m,b as p}from"./internal-context-tkv6NwcA.mjs";import{g as h}from"./getEmbeddedConnectedWallet-CSSBWE2p.mjs";import{u,g as d,a as g}from"./smart-wallets-CdsbAPBR.mjs";import"mipd";import"react-device-detect";import"viem/utils";import"@privy-io/js-sdk-core";import"viem";import"uuid";import"jose";import"eventemitter3";import"@coinbase/wallet-sdk";import"@privy-io/ethereum";import"@marsidev/react-turnstile";import"styled-components";import"tinycolor2";import"@heroicons/react/24/outline/DevicePhoneMobileIcon";import"@heroicons/react/24/outline/FingerPrintIcon";import"@heroicons/react/24/outline/PhoneIcon";import"@heroicons/react/24/outline/ShieldCheckIcon";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"@heroicons/react/24/outline/ChevronDownIcon";import"@heroicons/react/24/outline/CalendarIcon";import"@heroicons/react/24/outline/ExclamationTriangleIcon";import"@headlessui/react";import"@walletconnect/ethereum-provider";import"zustand";import"fast-password-entropy";import"secure-password-utilities";import"secure-password-utilities/wordlists";import"@heroicons/react/24/outline/UserCircleIcon";import"@heroicons/react/24/outline/EnvelopeIcon";import"@heroicons/react/20/solid/CheckIcon";import"@heroicons/react/24/outline/WalletIcon";import"@heroicons/react/24/outline/CheckIcon";import"@heroicons/react/24/outline/Square2StackIcon";import"@heroicons/react/24/outline/ExclamationCircleIcon";import"@heroicons/react/24/outline/ArrowTopRightOnSquareIcon";import"@heroicons/react/24/solid/DocumentCheckIcon";import"@heroicons/react/24/solid/XCircleIcon";import"@heroicons/react/24/solid/CheckCircleIcon";import"qrcode";import"@heroicons/react/24/solid/ArrowsRightLeftIcon";import"@heroicons/react/24/outline/ChevronRightIcon";import"@heroicons/react/24/outline/LockClosedIcon";import"@heroicons/react/24/outline/PencilSquareIcon";import"@heroicons/react/24/outline/ArrowPathIcon";import"@heroicons/react/24/outline/EyeIcon";import"@heroicons/react/24/outline/EyeSlashIcon";import"@heroicons/react/24/outline/KeyIcon";import"@heroicons/react/24/outline/ArrowDownTrayIcon";import"@heroicons/react/24/outline/ClipboardDocumentCheckIcon";import"@heroicons/react/24/outline/DocumentDuplicateIcon";import"@heroicons/react/24/solid/LockClosedIcon";import"@heroicons/react/24/outline/CheckCircleIcon";import"@heroicons/react/24/outline/InformationCircleIcon";import"@heroicons/react/24/outline/CreditCardIcon";import"@heroicons/react/24/outline/QrCodeIcon";import"@heroicons/react/24/outline/GlobeAltIcon";import"ofetch";import"@heroicons/react/24/outline";import"@heroicons/react/24/outline/ClipboardDocumentIcon";import"@heroicons/react/24/outline/CloudArrowUpIcon";import"@heroicons/react/24/outline/NoSymbolIcon";import"@heroicons/react/24/outline/ClockIcon";import"@heroicons/react/24/outline/TrashIcon";import"@heroicons/react/24/solid/CheckBadgeIcon";import"@heroicons/react/24/solid/IdentificationIcon";import"@heroicons/react/24/outline/MinusCircleIcon";import"@heroicons/react/24/outline/ArrowRightEndOnRectangleIcon";import"@heroicons/react/24/solid/ShieldCheckIcon";import"js-cookie";import"permissionless";import"permissionless/accounts";import"permissionless/clients/pimlico";import"viem/account-abstraction";let C=/*#__PURE__*/t({client:void 0,getClientForChain:p});const I=({config:e,children:i})=>/*#__PURE__*/o(y,{children:/*#__PURE__*/o(k,{config:e,children:/*#__PURE__*/o(b,{children:i})})}),f=()=>{let{client:o,getClientForChain:i}=e(C);return{client:o,getClientForChain:i}};let w=/*#__PURE__*/t({config:void 0}),v=()=>{let{config:o}=e(w);return{config:o}},y=({children:e})=>{let[t,n]=i(void 0),{client:c}=s();return r((()=>{!t&&c&&(async()=>{try{if(!c)return void console.warn("No client found");let o=await c.getSmartWalletsConfig();n(o)}catch(o){console.warn("Error generating smart wallet config: ",o)}})()}),[!!c]),/*#__PURE__*/o(w.Provider,{value:{config:t},children:e})},k=({config:e,children:t})=>{let{config:p}=v(),{appId:g}=s(),{chains:C,defaultChain:I,rpcConfig:f}=n(),{wallets:w}=c(),{user:y}=a(),[k,b]=i(),{wrapSmartAccountClientWithUIs:P}=u(),S=l(y),A=h(w);r((()=>{(async()=>{if(!p?.enabled)return;let o=p.configuredNetworks.find((o=>o.chainId===`eip155:${I.id}`))?I:C.find((o=>p.configuredNetworks.map((o=>o.chainId)).includes(`eip155:${o.id}`)));if(!o)throw new m("Could not find smart wallets chain configurations for any Privy client configured chains. Please configure smart wallets for your chains in the Privy dashboard.");b(await d({chain:o,privyAppId:g,paymasterContext:e?.paymasterContext,rpcConfig:f,account:S,signer:await(A?.getEthereumProvider()),user:y,smartWalletsConfig:p}))})()}),[!!p?.enabled,!!y?.smartWallet,!!A,!!S]);/*#__PURE__*/return o(W.Provider,{value:{client:k,config:e,getClientForChain:async({id:o})=>{let i=await d({chain:C.find((e=>e.id===o)),privyAppId:g,paymasterContext:e?.paymasterContext,rpcConfig:f,account:S,signer:await(A?.getEthereumProvider()),user:y,smartWalletsConfig:p});if(!i)throw new m(`Failed to create smart wallet client for chain id: ${o}`);return P(i)}},children:t})},W=/*#__PURE__*/t({client:void 0,config:void 0,getClientForChain:p}),b=({children:i})=>{let{client:t,config:n,getClientForChain:c}=(()=>{let{client:o,config:i,getClientForChain:r}=e(W);return{client:o,config:i,getClientForChain:r}})(),{config:l}=v(),{wrapSmartAccountClient:m}=g({clientConfig:n,smartWalletsConfig:l}),{user:p}=a(),{generateSiweMessageForSmartWallet:h,linkSmartWallet:u,hideWalletUIs:d}=s();return r((()=>{(async()=>{if(t&&p&&!p?.smartWallet&&l?.enabled)try{let o=await h({address:t.account.address,chainId:`eip155:${t.chain.id}`});d.current=!0;let e=await t.signMessage({message:o});await u({signature:e,message:o,smartWalletType:l.smartWalletType})}catch(o){console.error("Error creating smart wallet:",o)}finally{d.current=!1}})()}),[!!t,!!p?.smartWallet,!!l?.enabled]),/*#__PURE__*/o(C.Provider,{value:{client:p?.smartWallet&&t?m(t):void 0,getClientForChain:c},children:i})};export{I as SmartWalletsProvider,f as useSmartWallets};
