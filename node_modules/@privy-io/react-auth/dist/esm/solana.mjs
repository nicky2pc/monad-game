import{isWalletAdapterCompatibleStandardWallet as e}from"@solana/wallet-adapter-base";import{StandardWalletAdapter as t}from"@solana/wallet-standard-wallet-adapter-base";import{getWallets as n}from"@wallet-standard/app";import{aq as i,u as r,h as o,ar as s,as as a,f as c,F as l,at as d,q as p,b as h,au as m,l as g,av as A,aw as v,ax as w,ay as y,az as f,aA as b,aB as I,aC as T}from"./privy-provider-DkDa6JMm.mjs";export{S as useSolanaWallets}from"./privy-provider-DkDa6JMm.mjs";import{useCallback as P,useMemo as j,useEffect as C,useState as O}from"react";import{u as _,n as E}from"./internal-context-tkv6NwcA.mjs";import{VersionedTransaction as k,Connection as M,Transaction as B,TransactionInstruction as F,PublicKey as D}from"@solana/web3.js";import W from"eventemitter3";import{base58 as x}from"@scure/base";import{t as U}from"./useFundWallet-BGNujJ0T.mjs";export{u as useFundWallet}from"./useFundWallet-BGNujJ0T.mjs";import"react/jsx-runtime";import"mipd";import"react-device-detect";import"viem/utils";import"@privy-io/js-sdk-core";import"viem";import"uuid";import"jose";import"@coinbase/wallet-sdk";import"@privy-io/ethereum";import"@marsidev/react-turnstile";import"styled-components";import"tinycolor2";import"@heroicons/react/24/outline/DevicePhoneMobileIcon";import"@heroicons/react/24/outline/FingerPrintIcon";import"@heroicons/react/24/outline/PhoneIcon";import"@heroicons/react/24/outline/ShieldCheckIcon";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"@heroicons/react/24/outline/ChevronDownIcon";import"@heroicons/react/24/outline/CalendarIcon";import"@heroicons/react/24/outline/ExclamationTriangleIcon";import"@headlessui/react";import"@walletconnect/ethereum-provider";import"zustand";import"fast-password-entropy";import"secure-password-utilities";import"secure-password-utilities/wordlists";import"@heroicons/react/24/outline/UserCircleIcon";import"@heroicons/react/24/outline/EnvelopeIcon";import"@heroicons/react/20/solid/CheckIcon";import"@heroicons/react/24/outline/WalletIcon";import"@heroicons/react/24/outline/CheckIcon";import"@heroicons/react/24/outline/Square2StackIcon";import"@heroicons/react/24/outline/ExclamationCircleIcon";import"@heroicons/react/24/outline/ArrowTopRightOnSquareIcon";import"@heroicons/react/24/solid/DocumentCheckIcon";import"@heroicons/react/24/solid/XCircleIcon";import"@heroicons/react/24/solid/CheckCircleIcon";import"qrcode";import"@heroicons/react/24/solid/ArrowsRightLeftIcon";import"@heroicons/react/24/outline/ChevronRightIcon";import"@heroicons/react/24/outline/LockClosedIcon";import"@heroicons/react/24/outline/PencilSquareIcon";import"@heroicons/react/24/outline/ArrowPathIcon";import"@heroicons/react/24/outline/EyeIcon";import"@heroicons/react/24/outline/EyeSlashIcon";import"@heroicons/react/24/outline/KeyIcon";import"@heroicons/react/24/outline/ArrowDownTrayIcon";import"@heroicons/react/24/outline/ClipboardDocumentCheckIcon";import"@heroicons/react/24/outline/DocumentDuplicateIcon";import"@heroicons/react/24/solid/LockClosedIcon";import"@heroicons/react/24/outline/CheckCircleIcon";import"@heroicons/react/24/outline/InformationCircleIcon";import"@heroicons/react/24/outline/CreditCardIcon";import"@heroicons/react/24/outline/QrCodeIcon";import"@heroicons/react/24/outline/GlobeAltIcon";import"ofetch";import"@heroicons/react/24/outline";import"@heroicons/react/24/outline/ClipboardDocumentIcon";import"@heroicons/react/24/outline/CloudArrowUpIcon";import"@heroicons/react/24/outline/NoSymbolIcon";import"@heroicons/react/24/outline/ClockIcon";import"@heroicons/react/24/outline/TrashIcon";import"@heroicons/react/24/solid/CheckBadgeIcon";import"@heroicons/react/24/solid/IdentificationIcon";import"@heroicons/react/24/outline/MinusCircleIcon";import"@heroicons/react/24/outline/ArrowRightEndOnRectangleIcon";import"@heroicons/react/24/solid/ShieldCheckIcon";import"js-cookie";import"@solana/spl-token";const Q=e=>{let t,{get:r,on:o}=n(),s=e?.shouldAutoConnect??!0,a=new Map,c=[];function l(...e){J(e).forEach((e=>!a.has(e.wallet)&&a.set(e.wallet,e))),c=Array.from(a.values()).map((e=>new i(e,s))),t?.(c)}function u(...e){Array.from(a.keys()).forEach((t=>!e.includes(t)&&a.delete(t))),c=Array.from(a.values()).map((e=>new i(e,s))),t?.(c)}let d=[o("register",l),o("unregister",u)];return J(r()).forEach((e=>!a.has(e.wallet)&&a.set(e.wallet,e))),c=Array.from(a.values()).map((e=>new i(e,s))),{_setOnConnectorsUpdated:e=>{t=e},onMount:()=>{d[0]||(d[0]=o("register",l)),d[1]||(d[1]=o("unregister",u))},onUnmount:()=>{let e=d.pop();for(;e;)e(),e=d.pop()},get:()=>c}};let J=n=>n.filter((t=>e(t)&&!(t.features["privy:"]&&"isPrivyWallet"in t&&t.isPrivyWallet))).map((e=>new t({wallet:e})));const V=()=>{let{getAccessToken:e,user:t}=r(),{refreshSessionAndUser:n,initializeWalletProxy:i}=_(),a=o();return{importWallet:P((({privateKey:r})=>s({getAccessToken:e,user:t,initializeWalletProxy:i,refreshSessionAndUser:n,emitPrivyEvent:a},{privateKey:r,chainType:"solana"})),[t,e,n,i,a])}},q=["solana:mainnet","solana:devnet","solana:testnet"];function K(e){switch(e){case"solana:mainnet":return"mainnet-beta";case"solana:devnet":return"devnet";case"solana:testnet":return"testnet";default:throw Error(`Unknown chain: ${e}`)}}function R(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e}var z=0,G="__private_"+z+++"__implementation";function Y(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e}var H=0;function L(e){return"__private_"+H+++"_"+e}var Z=/*#__PURE__*/L("_address"),N=/*#__PURE__*/L("_publicKey"),X=/*#__PURE__*/L("_chains"),$=/*#__PURE__*/L("_features"),ee=/*#__PURE__*/L("_label"),te=/*#__PURE__*/L("_icon");class ne{get address(){return Y(this,Z)[Z]}get publicKey(){return Y(this,N)[N].slice()}get chains(){return Y(this,X)[X].slice()}get features(){return Y(this,$)[$].slice()}get label(){return Y(this,ee)[ee]}get icon(){return Y(this,te)[te]}constructor({address:e,publicKey:t,label:n,icon:i}){Object.defineProperty(this,Z,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),Y(this,Z)[Z]=e,Y(this,N)[N]=t,Y(this,X)[X]=q,Y(this,ee)[ee]=n,Y(this,te)[te]=i,Y(this,$)[$]=["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"],new.target===ne&&Object.freeze(this)}}function ie(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw TypeError("attempted to use private field on non-instance");return e}var re=0;function oe(e){return"__private_"+re+++"_"+e}var se=/*#__PURE__*/oe("_listeners"),ae=/*#__PURE__*/oe("_version"),ce=/*#__PURE__*/oe("_name"),le=/*#__PURE__*/oe("_icon"),ue=/*#__PURE__*/oe("_injection"),de=/*#__PURE__*/oe("_isPrivyWallet"),pe=/*#__PURE__*/oe("_accounts"),he=/*#__PURE__*/oe("_on"),me=/*#__PURE__*/oe("_emit"),ge=/*#__PURE__*/oe("_off"),Ae=/*#__PURE__*/oe("_connected"),ve=/*#__PURE__*/oe("_connect"),we=/*#__PURE__*/oe("_disconnect"),ye=/*#__PURE__*/oe("_signMessage"),fe=/*#__PURE__*/oe("_signAndSendTransaction"),be=/*#__PURE__*/oe("_signTransaction");function Ie(e,...t){ie(this,se)[se][e]?.forEach((e=>e.apply(null,t)))}function Te(e,t){ie(this,se)[se][e]=ie(this,se)[se][e]?.filter((e=>t!==e))}function Pe(e){let t=c(),{getAccessToken:n,user:i}=l(),{setModalData:r}=d(),{isHeadlessSigning:s,openModal:a,walletProxy:u,recoverEmbeddedWallet:g,privy:A}=_(),v=o(),{signWithUserSigner:w}=p();return h("signSolanaTransaction",e),{signTransaction:async({transaction:e,connection:o,uiOptions:c,transactionOptions:l,address:d})=>{let{signedTransaction:p}=await m({privy:A,appConfig:t,getAccessToken:n,isHeadlessSigning:s,emitPrivyEvent:v,setModalData:r,openModal:a,walletProxy:u,user:i,recoverEmbeddedWallet:g,signWithUserSigner:w},{transaction:e,connection:o,transactionOptions:l,uiOptions:c,address:d,signOnly:!0});return p}}}let je=new class extends W{setImplementation(e){R(this,G)[G]=e}async signMessage(e,t){return R(this,G)[G].signMessage(e,t)}async signAndSendTransaction(e,t,n,i){return R(this,G)[G].signAndSendTransaction(e,t,n,i)}async signTransaction(e,t,n,i){return R(this,G)[G].signTransaction(e,t,n,i)}constructor(e){super(),Object.defineProperty(this,G,{writable:!0,value:void 0}),R(this,G)[G]=e}}({signTransaction:E("signTransaction was not injected"),signAndSendTransaction:E("signAndSendTransaction was not injected"),signMessage:E("signMessage was not injected")}),Ce=new class{get version(){return ie(this,ae)[ae]}get name(){return ie(this,ce)[ce]}get icon(){return ie(this,le)[le]}get chains(){return q.slice()}get features(){return{"standard:connect":{version:"1.0.0",connect:ie(this,ve)[ve]},"standard:disconnect":{version:"1.0.0",disconnect:ie(this,we)[we]},"standard:events":{version:"1.0.0",on:ie(this,he)[he]},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:ie(this,fe)[fe]},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:ie(this,be)[be]},"solana:signMessage":{version:"1.0.0",signMessage:ie(this,ye)[ye]},"privy:":{privy:{signMessage:ie(this,ue)[ue].signMessage,signTransaction:ie(this,ue)[ue].signTransaction,signAndSendTransaction:ie(this,ue)[ue].signAndSendTransaction}}}}get accounts(){return ie(this,pe)[pe].slice()}get isPrivyWallet(){return ie(this,de)[de]}constructor({name:e,icon:t,version:n,injection:i,wallets:r}){Object.defineProperty(this,me,{value:Ie}),Object.defineProperty(this,ge,{value:Te}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,ce,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,Ae,{writable:!0,value:void 0}),Object.defineProperty(this,ve,{writable:!0,value:void 0}),Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,ye,{writable:!0,value:void 0}),Object.defineProperty(this,fe,{writable:!0,value:void 0}),Object.defineProperty(this,be,{writable:!0,value:void 0}),ie(this,se)[se]={},ie(this,he)[he]=(e,t)=>(ie(this,se)[se][e]?.push(t)||(ie(this,se)[se][e]=[t]),()=>ie(this,ge)[ge](e,t)),ie(this,Ae)[Ae]=e=>{null!=e&&(ie(this,pe)[pe]=e.map((({address:e})=>new ne({address:e,publicKey:x.decode(e)})))),ie(this,me)[me]("change",{accounts:this.accounts})},ie(this,ve)[ve]=async()=>(ie(this,me)[me]("change",{accounts:this.accounts}),{accounts:this.accounts}),ie(this,we)[we]=async()=>{ie(this,me)[me]("change",{accounts:this.accounts})},ie(this,ye)[ye]=async(...e)=>{let t=[];for(let{message:n,account:i}of e){let{signature:e}=await ie(this,ue)[ue].signMessage(n,i.address);t.push({signedMessage:n,signature:e})}return t},ie(this,fe)[fe]=async(...e)=>{let t=[];for(let{transaction:n,account:i,options:r,chain:o}of e){let{signature:e}=await ie(this,ue)[ue].signAndSendTransaction(k.deserialize(n),i.address,K(o||"solana:mainnet"),r);t.push({signature:x.decode(e)})}return t},ie(this,be)[be]=async(...e)=>{let t=[];for(let{transaction:n,account:i,options:r,chain:o}of e){let e=await ie(this,ue)[ue].signTransaction(k.deserialize(n),i.address,K(o||"solana:mainnet"),r),s=a(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}));t.push({signedTransaction:s})}return t},ie(this,ce)[ce]=e,ie(this,le)[le]=t,ie(this,ae)[ae]=n,ie(this,ue)[ue]=i,ie(this,pe)[pe]=[],ie(this,de)[de]=!0,i.on("accountChanged",ie(this,Ae)[Ae],this),ie(this,Ae)[Ae](r)}}({name:"Privy",version:"1.0.0",icon:"data:image/png;base64,AAABAAEAFBQAAAAAIABlAQAAFgAAAIlQTkcNChoKAAAADUlIRFIAAAAUAAAAFAgGAAAAjYkdDQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAQVJREFUeJxiYMANZIC4E4ivAPFPIP4FxDeAuB+IlfDowwBMQFwJxF+B+D8O/AOI66Bq8QJGIF6ExyB0vAqImfEZmEeCYTDcgMswPiB+T4aB34FYApuBsWQYBsP52AycToGBK7EZuJECAw9jM3AVBQbuwWZgIwUGTsZmoDkFBnpiMxAEjpJh2FV8iVsbiD+TYBgoDVrgMgwGnID4HRGGgTKBGyHDYEAaiBdCSxh0g/5AU4Q8sYYhAzEgjoGmABBOgFo2eACowFABYn0oVgViAVINkQTiZUD8DIj/ATF6GILEXgLxCiCWIsZAbiAuBeKtQHwHiEHJ6C8UfwHie0C8E4jLoWpRAAAAAP//rcbhsQAAAAZJREFUAwBYFs3VKJ0cuQAAAABJRU5ErkJggg==",wallets:[],injection:je});function Oe(){let{solanaClusters:e}=c(),{ready:t}=g(),{user:n}=l(),{signMessage:i}=A(),{signTransaction:r}=Pe(),{sendTransaction:o}=v(),s=j((()=>{let e=[...w(n).sort(((e,t)=>(e.walletIndex??0)-(t.walletIndex??0)))],t=y(n);return t?[...e,t]:e}),[n]),a=j((()=>({signMessage:async(e,t)=>({signature:await i({message:e,options:{address:t}})}),async signTransaction(t,n,i){let o=new M(e[i].rpcUrl);return await r({transaction:t,address:n,connection:o})},async signAndSendTransaction(t,n,i,r){let s=new M(e[i].rpcUrl),{signature:a}=await o({transaction:t,connection:s,address:n,transactionOptions:r});return{signature:a}}})),[i,r,o,e]);return C((()=>{je?.setImplementation(a)}),[a]),C((()=>{var e;!t||(e=Ce.accounts).length===s.length&&e.every(((e,t)=>e.address===s[t]?.address))||je?.emit("accountChanged",s)}),[t,s]),{ready:t,wallet:Ce}}function Se(){let{connectors:e}=_(),{ready:t,wallet:n}=Oe(),[i,r]=O([]);return C((()=>{if(!t)return;let i=[n,...e.filter((e=>"solana"===e.chainType)).map((e=>e.wallet))];r(i);let o=i.map((e=>e.features["standard:events"]?.on("change",(()=>{r([...i])}))));return()=>{o.forEach((e=>e?.()))}}),[t,e]),{ready:t,wallets:i}}var _e=()=>f(U),Ee={id:b,prepareSiwsTransactionWithMemo:({address:e,nonce:t})=>{let n=I({address:e,nonce:t}),i=new B,r=new F({keys:[{pubkey:new D(e),isSigner:!0,isWritable:!1}],programId:new D("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),data:Buffer.from(n,"utf-8")});return i.add(r),i.feePayer=new D(e),i.recentBlockhash="GfVcyD5fWFJ6hRm8bsy7CoVPsLSoJhtJKRJYk8T2VVFN",i.serialize({requireAllSignatures:!1}).toString("base64")},deserializeTransactionFromB64String:e=>B.from(T(e,"base64"))},ke=()=>f(Ee);export{i as SolanaAdapterConnector,Q as toSolanaWalletConnectors,V as useImportWallet,Oe as usePrivyStandardWallet,v as useSendTransaction,A as useSignMessage,Pe as useSignTransaction,_e as useSolanaFundingPlugin,ke as useSolanaLedgerPlugin,Se as useSolanaStandardWallets};
