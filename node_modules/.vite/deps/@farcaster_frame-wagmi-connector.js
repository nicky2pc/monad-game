import {
  ChainNotConfiguredError,
  createConnector
} from "./chunk-UHYYLMWF.js";
import {
  dist_default
} from "./chunk-7EXAWHE6.js";
import "./chunk-6XNWDSHI.js";
import "./chunk-JXENMFVZ.js";
import "./chunk-JSXPVEQS.js";
import {
  SwitchChainError,
  fromHex,
  getAddress,
  numberToHex
} from "./chunk-VCTUTBQJ.js";
import "./chunk-EHA5XAWF.js";
import "./chunk-FJXQD5XT.js";
import "./chunk-7TTLHRTU.js";
import "./chunk-6VWO3YVD.js";
import "./chunk-OS7ZSSJM.js";

// node_modules/@farcaster/frame-wagmi-connector/dist/connector.js
farcasterFrame.type = "farcasterFrame";
var accountsChanged;
var chainChanged;
var disconnect;
function farcasterFrame() {
  return createConnector((config) => ({
    id: "farcaster",
    name: "Farcaster",
    rdns: "xyz.farcaster.MiniAppWallet",
    icon: "https://imagedelivery.net/BXluQx4ige9GuW0Ia56BHw/055c25d6-7fe7-4a49-abf9-49772021cf00/original",
    type: farcasterFrame.type,
    async connect({ chainId } = {}) {
      const provider = await this.getProvider();
      const accounts = await provider.request({
        method: "eth_requestAccounts"
      });
      if (!accountsChanged) {
        accountsChanged = this.onAccountsChanged.bind(this);
        provider.on("accountsChanged", accountsChanged);
      }
      if (!chainChanged) {
        chainChanged = this.onChainChanged.bind(this);
        provider.on("chainChanged", chainChanged);
      }
      if (!disconnect) {
        disconnect = this.onDisconnect.bind(this);
        provider.on("disconnect", disconnect);
      }
      let currentChainId = await this.getChainId();
      if (chainId && currentChainId !== chainId) {
        const chain = await this.switchChain({ chainId });
        currentChainId = chain.id;
      }
      return {
        accounts: accounts.map((x) => getAddress(x)),
        chainId: currentChainId
      };
    },
    async disconnect() {
      const provider = await this.getProvider();
      if (accountsChanged) {
        provider.removeListener("accountsChanged", accountsChanged);
        accountsChanged = void 0;
      }
      if (chainChanged) {
        provider.removeListener("chainChanged", chainChanged);
        chainChanged = void 0;
      }
      if (disconnect) {
        provider.removeListener("disconnect", disconnect);
        disconnect = void 0;
      }
    },
    async getAccounts() {
      const provider = await this.getProvider();
      const accounts = await provider.request({
        method: "eth_accounts"
      });
      return accounts.map((x) => getAddress(x));
    },
    async getChainId() {
      const provider = await this.getProvider();
      const hexChainId = await provider.request({ method: "eth_chainId" });
      return fromHex(hexChainId, "number");
    },
    async isAuthorized() {
      try {
        const accounts = await this.getAccounts();
        return !!accounts.length;
      } catch {
        return false;
      }
    },
    async switchChain({ chainId }) {
      const provider = await this.getProvider();
      const chain = config.chains.find((x) => x.id === chainId);
      if (!chain) {
        throw new SwitchChainError(new ChainNotConfiguredError());
      }
      await provider.request({
        method: "wallet_switchEthereumChain",
        params: [{ chainId: numberToHex(chainId) }]
      });
      config.emitter.emit("change", { chainId });
      return chain;
    },
    onAccountsChanged(accounts) {
      if (accounts.length === 0) {
        this.onDisconnect();
      } else {
        config.emitter.emit("change", {
          accounts: accounts.map((x) => getAddress(x))
        });
      }
    },
    onChainChanged(chain) {
      const chainId = Number(chain);
      config.emitter.emit("change", { chainId });
    },
    async onDisconnect() {
      config.emitter.emit("disconnect");
    },
    async getProvider() {
      return dist_default.wallet.ethProvider;
    }
  }));
}

// node_modules/@farcaster/frame-wagmi-connector/dist/index.js
var dist_default2 = farcasterFrame;
export {
  dist_default2 as default,
  farcasterFrame
};
//# sourceMappingURL=@farcaster_frame-wagmi-connector.js.map
